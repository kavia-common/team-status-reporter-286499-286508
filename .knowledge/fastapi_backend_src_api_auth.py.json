{"is_source_file": true, "format": "Python", "description": "This file defines authentication endpoints for a FastAPI backend, including user registration, login, token refresh, and user profile retrieval, along with utility functions for JWT token handling and cookie management.", "external_files": ["src.api.config", "src.api.db", "src.api.models", "src.api.schemas"], "external_methods": ["get_session_factory", "session_scope", "Base.metadata.create_all", "get_engine"], "published": ["router"], "classes": [{"name": "LocalUser", "description": "User model representing local users in the database."}], "methods": [{"name": "str _create_jwt_token(subject: str, expires_delta: timedelta)", "description": "Generates a JWT token with the specified subject and expiry.", "scope": "", "scopeKind": ""}, {"name": "str _get_access_token(user_id: str)", "description": "Creates an access JWT token for a given user ID.", "scope": "", "scopeKind": ""}, {"name": "str _get_refresh_token(user_id: str)", "description": "Creates a refresh JWT token for a given user ID.", "scope": "", "scopeKind": ""}, {"name": "_set_refresh_cookie(resp: Response, token: str)", "description": "Sets an HttpOnly cookie with the refresh token.", "scope": "", "scopeKind": ""}, {"name": "_clear_refresh_cookie(resp: Response)", "description": "Deletes the refresh token cookie.", "scope": "", "scopeKind": ""}, {"name": "bool _verify_password(plain_password: str, password_hash: str)", "description": "Verifies a plaintext password against its hash.", "scope": "", "scopeKind": ""}, {"name": "str _hash_password(password: str)", "description": "Hashes a plaintext password.", "scope": "", "scopeKind": ""}, {"name": "_init_db()", "description": "Creates database tables if not existing.", "scope": "", "scopeKind": ""}, {"name": "Session _get_db()", "description": "Provides a database session.", "scope": "", "scopeKind": ""}, {"name": "TokenResponse register(payload: RegisterRequest, response: Response)", "description": "Handles user registration, stores hashed password, and returns access tokens.", "scope": "", "scopeKind": ""}, {"name": "TokenResponse login(payload: LoginRequest, response: Response)", "description": "Verifies user credentials and returns access tokens.", "scope": "", "scopeKind": ""}, {"name": "str _decode_token(token: str)", "description": "Decodes a JWT token to extract the subject (user ID).", "scope": "", "scopeKind": ""}, {"name": "LocalUser _get_current_user(request: Request)", "description": "Retrieves the current user from the request's bearer token.", "scope": "", "scopeKind": ""}, {"name": "UserOut me(current_user: Annotated[LocalUser, Depends(_get_current_user)])", "description": "Returns information about the current authenticated user.", "scope": "", "scopeKind": ""}, {"name": "MessageResponse logout(response: Response)", "description": "Clears the refresh token cookie to log out the user.", "scope": "", "scopeKind": ""}, {"name": "TokenResponse refresh(request: Request)", "description": "Uses the refresh token cookie to generate a new access token.", "scope": "", "scopeKind": ""}], "calls": ["session_scope()", "Base.metadata.create_all()", "get_engine()", "get_session_factory()", "_decode_token()", "_get_access_token()", "_get_refresh_token()", "_set_refresh_cookie()", "_clear_refresh_cookie()", "_verify_password()", "_hash_password()"], "search-terms": ["auth endpoints", "JWT token creation", "FastAPI auth router", "cookie management", "user registration", "refresh token", "login", "logout", "user profile", "JWT secret config"], "state": 2, "file_id": 10, "knowledge_revision": 21, "git_revision": "", "ctags": [{"_type": "tag", "name": "_clear_refresh_cookie", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def _clear_refresh_cookie(resp: Response):$/", "language": "Python", "kind": "function", "signature": "(resp: Response)"}, {"_type": "tag", "name": "_create_jwt_token", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def _create_jwt_token(subject: str, expires_delta: timedelta) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(subject: str, expires_delta: timedelta)"}, {"_type": "tag", "name": "_decode_token", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def _decode_token(token: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "_get_access_token", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def _get_access_token(user_id: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(user_id: str)"}, {"_type": "tag", "name": "_get_current_user", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def _get_current_user(request: Request) -> LocalUser:$/", "language": "Python", "typeref": "typename:LocalUser", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "_get_db", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def _get_db() -> Session:$/", "language": "Python", "typeref": "typename:Session", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_get_refresh_token", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def _get_refresh_token(user_id: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(user_id: str)"}, {"_type": "tag", "name": "_hash_password", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def _hash_password(password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(password: str)"}, {"_type": "tag", "name": "_init_db", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def _init_db():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_set_refresh_cookie", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def _set_refresh_cookie(resp: Response, token: str):$/", "language": "Python", "kind": "function", "signature": "(resp: Response, token: str)"}, {"_type": "tag", "name": "_verify_password", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def _verify_password(plain_password: str, password_hash: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(plain_password: str, password_hash: str)"}, {"_type": "tag", "name": "login", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def login(payload: LoginRequest, response: Response) -> TokenResponse:$/", "language": "Python", "typeref": "typename:TokenResponse", "kind": "function", "signature": "(payload: LoginRequest, response: Response)"}, {"_type": "tag", "name": "logout", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def logout(response: Response) -> MessageResponse:$/", "language": "Python", "typeref": "typename:MessageResponse", "kind": "function", "signature": "(response: Response)"}, {"_type": "tag", "name": "me", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def me(current_user: Annotated[LocalUser, Depends(_get_current_user)]) -> UserOut:$/", "language": "Python", "typeref": "typename:UserOut", "kind": "function", "signature": "(current_user: Annotated[LocalUser, Depends(_get_current_user)])"}, {"_type": "tag", "name": "pwd_context", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "refresh", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def refresh(request: Request) -> TokenResponse:$/", "language": "Python", "typeref": "typename:TokenResponse", "kind": "function", "signature": "(request: Request)"}, {"_type": "tag", "name": "register", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^def register(payload: RegisterRequest, response: Response) -> TokenResponse:$/", "language": "Python", "typeref": "typename:TokenResponse", "kind": "function", "signature": "(payload: RegisterRequest, response: Response)"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/team-status-reporter-286499-286508/fastapi_backend/src/api/auth.py", "pattern": "/^router = APIRouter(prefix=\"\\/auth\", tags=[\"Auth\"])$/", "language": "Python", "kind": "variable"}], "hash": "9690ae781fbd15df35605c69767e5a39", "format-version": 4, "code-base-name": "fastapi_backend", "filename": "fastapi_backend/src/api/auth.py", "fields": [{"name": "pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/auth\", tags=[\"Auth\"])", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"21": ""}]}